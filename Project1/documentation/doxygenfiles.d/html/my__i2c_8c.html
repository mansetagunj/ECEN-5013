<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>ECEN5013 Project1 - Gunj Manseta: /home/gunj/repos/ECEN-5013/Project1/src/my_i2c.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ECEN5013 Project1 - Gunj Manseta
   </div>
   <div id="projectbrief">A multithreaded console application for BeagleBone black/green(Linux) having sensor interface, server, and logger</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">my_i2c.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="my__i2c_8h_source.html">my_i2c.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for my_i2c.c:</div>
<div class="dyncontent">
<div class="center"><img src="my__i2c_8c__incl.png" border="0" usemap="#_2home_2gunj_2repos_2ECEN-5013_2Project1_2src_2my__i2c_8c" alt=""/></div>
<map name="_2home_2gunj_2repos_2ECEN-5013_2Project1_2src_2my__i2c_8c" id="_2home_2gunj_2repos_2ECEN-5013_2Project1_2src_2my__i2c_8c">
<area shape="rect" id="node4" href="my__i2c_8h.html" title="my_i2c.h" alt="" coords="182,95,257,121"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a24206855ca77b181de1cfbe8e9e5051a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__i2c_8c.html#a24206855ca77b181de1cfbe8e9e5051a">printErrorCode</a> (int errorCode)</td></tr>
<tr class="memdesc:a24206855ca77b181de1cfbe8e9e5051a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the error code string to stdout.  <a href="#a24206855ca77b181de1cfbe8e9e5051a">More...</a><br /></td></tr>
<tr class="separator:a24206855ca77b181de1cfbe8e9e5051a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acea2b6a0875bf63a179959a46b3cdf7d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__i2c_8c.html#acea2b6a0875bf63a179959a46b3cdf7d">I2Cmaster_Init</a> (<a class="el" href="my__i2c_8h.html#ab57e25e9caf06380c1d3587fa9866c1e">I2C_MASTER_HANDLE_T</a> *handle)</td></tr>
<tr class="memdesc:acea2b6a0875bf63a179959a46b3cdf7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inits the I2C master handle There is an internal state of the context which is maintained which gets updated with every init call Internal context goes to NULL is error in init This context points to the new handle that is passed as the parameter.  <a href="#acea2b6a0875bf63a179959a46b3cdf7d">More...</a><br /></td></tr>
<tr class="separator:acea2b6a0875bf63a179959a46b3cdf7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15136dcc397f046d0a000a781d060139"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__i2c_8c.html#a15136dcc397f046d0a000a781d060139">I2Cmaster_Destroy</a> (<a class="el" href="my__i2c_8h.html#ab57e25e9caf06380c1d3587fa9866c1e">I2C_MASTER_HANDLE_T</a> *handle)</td></tr>
<tr class="separator:a15136dcc397f046d0a000a781d060139"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a896771a0a066b06b606d35bb81809fa0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="my__i2c_8h.html#ab57e25e9caf06380c1d3587fa9866c1e">I2C_MASTER_HANDLE_T</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__i2c_8c.html#a896771a0a066b06b606d35bb81809fa0">getMasterI2C_handle</a> ()</td></tr>
<tr class="memdesc:a896771a0a066b06b606d35bb81809fa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the MasterI2C handle object.  <a href="#a896771a0a066b06b606d35bb81809fa0">More...</a><br /></td></tr>
<tr class="separator:a896771a0a066b06b606d35bb81809fa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a202be1d68320e3ba93c759821ba2f695"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__i2c_8c.html#a202be1d68320e3ba93c759821ba2f695">I2Cmaster_write_byte</a> (uint8_t slave_addr, uint8_t reg_addr, uint8_t data)</td></tr>
<tr class="separator:a202be1d68320e3ba93c759821ba2f695"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af92cf5a5d893ef9bbf6b4ee6de0b0ef8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__i2c_8c.html#af92cf5a5d893ef9bbf6b4ee6de0b0ef8">I2Cmaster_write</a> (uint8_t slave_addr, uint8_t reg_addr)</td></tr>
<tr class="memdesc:af92cf5a5d893ef9bbf6b4ee6de0b0ef8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a byte/pointer register to the slave.  <a href="#af92cf5a5d893ef9bbf6b4ee6de0b0ef8">More...</a><br /></td></tr>
<tr class="separator:af92cf5a5d893ef9bbf6b4ee6de0b0ef8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19c6244da5ea2d4e65a25001582498c8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__i2c_8c.html#a19c6244da5ea2d4e65a25001582498c8">I2Cmaster_write_word</a> (uint8_t slave_addr, uint8_t reg_addr, uint16_t data, uint8_t lsb_first)</td></tr>
<tr class="separator:a19c6244da5ea2d4e65a25001582498c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8024ad1f3558034ee998758f45d456d9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__i2c_8c.html#a8024ad1f3558034ee998758f45d456d9">I2Cmaster_read_byte</a> (uint8_t slave_addr, uint8_t reg_addr, uint8_t *data)</td></tr>
<tr class="separator:a8024ad1f3558034ee998758f45d456d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab25650a9cf74e65561b1fced3555f36c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="my__i2c_8c.html#ab25650a9cf74e65561b1fced3555f36c">I2Cmaster_read_bytes</a> (uint8_t slave_addr, uint8_t reg_addr, uint8_t *data, size_t len)</td></tr>
<tr class="separator:ab25650a9cf74e65561b1fced3555f36c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>Gunj Manseta </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2018-03-13 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a896771a0a066b06b606d35bb81809fa0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="my__i2c_8h.html#ab57e25e9caf06380c1d3587fa9866c1e">I2C_MASTER_HANDLE_T</a>* getMasterI2C_handle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the MasterI2C handle object. </p>
<dl class="section return"><dt>Returns</dt><dd>I2C_MASTER_HANDLE_T * </dd></dl>
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;{</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">return</span> internal_master_handle;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a15136dcc397f046d0a000a781d060139"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int I2Cmaster_Destroy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="my__i2c_8h.html#ab57e25e9caf06380c1d3587fa9866c1e">I2C_MASTER_HANDLE_T</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<div class="fragment"><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;{</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordflow">if</span>(pthread_mutex_lock(&amp;init_destroy_lock))</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">/* If the input handle is not null and the input initialized handle should match the internal handle */</span>    </div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">if</span>(NULL != handle &amp;&amp; internal_master_handle == handle &amp;&amp; NULL != internal_master_handle)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        ret = mraa_i2c_stop(handle-&gt;i2c_context);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">if</span>(ret == 0)</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            <span class="keyword">static</span> <span class="keywordtype">int</span> timeout = 5000;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keywordflow">do</span>{</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                ret = pthread_spin_destroy(&amp;handle-&gt;handle_lock);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                timeout--;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            }<span class="keywordflow">while</span>(EBUSY == ret &amp;&amp; timeout &gt; 0);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="keywordflow">if</span>(ret == 0)</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            {</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                internal_master_handle = NULL;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            }</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        }</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(NULL == internal_master_handle)</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        ret = 0;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">else</span> </div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        ret = -1;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">if</span>(pthread_mutex_unlock(&amp;init_destroy_lock))</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;} </div></div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="my__i2c_8c_a15136dcc397f046d0a000a781d060139_icgraph.png" border="0" usemap="#my__i2c_8c_a15136dcc397f046d0a000a781d060139_icgraph" alt=""/></div>
<map name="my__i2c_8c_a15136dcc397f046d0a000a781d060139_icgraph" id="my__i2c_8c_a15136dcc397f046d0a000a781d060139_icgraph">
<area shape="rect" id="node2" href="light__sensor__task_8c.html#abb5f74ca3376b1b610b7dac47ecae8d8" title="light_task_queue_init" alt="" coords="209,5,353,32"/>
<area shape="rect" id="node4" href="temperature__sensor__task_8c.html#a7b3917c753224bc64f378ca8e61cc941" title="temperature_task_I2Cdeinit" alt="" coords="189,56,372,83"/>
<area shape="rect" id="node3" href="light__sensor__task_8h.html#a638f4ba787ad818d90477af9e572771c" title="Entry point of the light task thread. " alt="" coords="443,5,576,32"/>
<area shape="rect" id="node5" href="temperature__sensor__task_8h.html#abc96664d611b8a19036cf6fcaaf92ac8" title="Entry point of the temp task thread. " alt="" coords="420,56,599,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acea2b6a0875bf63a179959a46b3cdf7d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int I2Cmaster_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="my__i2c_8h.html#ab57e25e9caf06380c1d3587fa9866c1e">I2C_MASTER_HANDLE_T</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inits the I2C master handle There is an internal state of the context which is maintained which gets updated with every init call Internal context goes to NULL is error in init This context points to the new handle that is passed as the parameter. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int SUCCESS=0 and ERROR =-1 </dd></dl>
<div class="fragment"><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keywordtype">int</span> ret = 0;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">if</span>(pthread_mutex_lock(&amp;init_destroy_lock))</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordflow">if</span>(NULL != internal_master_handle)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    {</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        handle = internal_master_handle;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        ret =  0;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    }</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(handle)</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    {</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        handle-&gt;i2c_context = mraa_i2c_init_raw(BB_I2C_BUS_2);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="comment">/* internal i2c context failed to init */</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keywordflow">if</span>(NULL == handle-&gt;i2c_context)</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        {</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            internal_master_handle = NULL;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;            ret = -1;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        }</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        <span class="comment">/* If spinlock init fails */</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( -1 == pthread_spin_init(&amp;handle-&gt;handle_lock, PTHREAD_PROCESS_PRIVATE))</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        {</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            internal_master_handle = NULL;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            mraa_i2c_stop(handle-&gt;i2c_context);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;            ret = -1;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        }</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="comment">/* Everyting goes as expected */</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            internal_master_handle = handle;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            ret = 0;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">/* If handle is null */</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        ret = -1;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">if</span>(pthread_mutex_unlock(&amp;init_destroy_lock))</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;}</div></div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="my__i2c_8c_acea2b6a0875bf63a179959a46b3cdf7d_icgraph.png" border="0" usemap="#my__i2c_8c_acea2b6a0875bf63a179959a46b3cdf7d_icgraph" alt=""/></div>
<map name="my__i2c_8c_acea2b6a0875bf63a179959a46b3cdf7d_icgraph" id="my__i2c_8c_acea2b6a0875bf63a179959a46b3cdf7d_icgraph">
<area shape="rect" id="node2" href="light__sensor__task_8c.html#abb5f74ca3376b1b610b7dac47ecae8d8" title="light_task_queue_init" alt="" coords="173,5,317,32"/>
<area shape="rect" id="node4" href="temperature__sensor__task_8c.html#ad16d2f35c6d97e33cfe57e3ab2497064" title="temperature_task_I2Cinit" alt="" coords="161,56,329,83"/>
<area shape="rect" id="node3" href="light__sensor__task_8h.html#a638f4ba787ad818d90477af9e572771c" title="Entry point of the light task thread. " alt="" coords="400,5,533,32"/>
<area shape="rect" id="node5" href="temperature__sensor__task_8h.html#abc96664d611b8a19036cf6fcaaf92ac8" title="Entry point of the temp task thread. " alt="" coords="377,56,556,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8024ad1f3558034ee998758f45d456d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int I2Cmaster_read_byte </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>reg_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave_addr</td><td></td></tr>
    <tr><td class="paramname">reg_addr</td><td></td></tr>
    <tr><td class="paramname">data</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<div class="fragment"><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;{</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span>(NULL == internal_master_handle)</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    pthread_spin_lock(&amp;internal_master_handle-&gt;handle_lock);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    mraa_result_t ret =  mraa_i2c_address(internal_master_handle-&gt;i2c_context, slave_addr);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">if</span>(0 == ret)</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    {   </div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        ret = mraa_i2c_read_byte_data(internal_master_handle-&gt;i2c_context, reg_addr);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        (ret != -1) ? *data  = ret, ret = 0 : 0; </div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    pthread_spin_unlock(&amp;internal_master_handle-&gt;handle_lock);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div></div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="my__i2c_8c_a8024ad1f3558034ee998758f45d456d9_icgraph.png" border="0" usemap="#my__i2c_8c_a8024ad1f3558034ee998758f45d456d9_icgraph" alt=""/></div>
<map name="my__i2c_8c_a8024ad1f3558034ee998758f45d456d9_icgraph" id="my__i2c_8c_a8024ad1f3558034ee998758f45d456d9_icgraph">
<area shape="rect" id="node2" href="apds9301__sensor_8h.html#a2aa3244d3848324ba9f4afc7b1990ce1" title="APDS9301_readControlReg" alt="" coords="219,5,404,32"/>
<area shape="rect" id="node3" href="apds9301__sensor_8h.html#a5e527c870fed599e87d712a151e47172" title="APDS9301_mode_highGain" alt="" coords="219,56,403,83"/>
<area shape="rect" id="node4" href="apds9301__sensor_8h.html#aa8c71ee19fe0ef5ff8880f87daa2757a" title="APDS9301_mode_lowGain\l_default" alt="" coords="221,107,401,149"/>
<area shape="rect" id="node6" href="apds9301__sensor_8h.html#a69d91df573c8c448a30715ae605262d7" title="APDS9301_mode_interrupt" alt="" coords="221,173,401,200"/>
<area shape="rect" id="node7" href="apds9301__sensor_8h.html#ad22326035668d08e6d7cade8cde126e4" title="APDS9301_mode_manualcontrol" alt="" coords="204,224,419,251"/>
<area shape="rect" id="node8" href="apds9301__sensor_8h.html#ac14a5a102513243824d12e6028abbeb8" title="APDS9301_mode_integrationTime" alt="" coords="200,275,423,301"/>
<area shape="rect" id="node9" href="apds9301__sensor_8h.html#a82dac2bc9fc0e11fc4589f3492bec13e" title="APDS9301_readID" alt="" coords="245,325,378,352"/>
<area shape="rect" id="node13" href="apds9301__sensor_8h.html#ae41babc910792ba1bbb19e837fd45d4c" title="APDS9301_readCh0" alt="" coords="240,376,383,403"/>
<area shape="rect" id="node18" href="apds9301__sensor_8h.html#a34c034b815ceb2e30b0161d7461f0a8e" title="APDS9301_readCh1" alt="" coords="240,427,383,453"/>
<area shape="rect" id="node19" href="apds9301__sensor_8h.html#acae5d5b1cfb4008743589e5482d7578b" title="Gives a memdump of 15 len. IMP must free the address using return pointer. " alt="" coords="232,477,391,504"/>
<area shape="rect" id="node5" href="apds9301__sensor_8h.html#a47621b827697481f12f3bf6257118f70" title="Sets back the default configration of the sensor. " alt="" coords="471,115,684,141"/>
<area shape="rect" id="node10" href="apds9301__sensor_8h.html#a29ea2301a68de775fc0281dd1b4b03aa" title="APDS9301_test" alt="" coords="519,325,635,352"/>
<area shape="rect" id="node11" href="light__sensor__task_8c.html#abb5f74ca3376b1b610b7dac47ecae8d8" title="light_task_queue_init" alt="" coords="732,325,876,352"/>
<area shape="rect" id="node12" href="light__sensor__task_8h.html#a638f4ba787ad818d90477af9e572771c" title="Entry point of the light task thread. " alt="" coords="939,325,1072,352"/>
<area shape="rect" id="node14" href="apds9301__sensor_8h.html#a55e164e7dd0586de71a8dd5b25ae9ef3" title="APDS9301_getLux" alt="" coords="511,401,644,428"/>
<area shape="rect" id="node15" href="light__sensor__task_8h.html#ac88a5567bdeac532053519330e94c6ab" title="Get the LightTask lux object. MT&#45;safe as it calls a MT&#45;safe function within. " alt="" coords="743,401,865,428"/>
<area shape="rect" id="node16" href="socket__task_8c.html#adb9b673e72054ada7a350a7bb51dff05" title="processRemoteRequest" alt="" coords="924,401,1087,428"/>
<area shape="rect" id="node17" href="socket__task_8h.html#a11efeb37f1a462e32c153a30ba11f53a" title="socket_task_callback" alt="" coords="1135,401,1283,428"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab25650a9cf74e65561b1fced3555f36c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int I2Cmaster_read_bytes </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>reg_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave_addr</td><td></td></tr>
    <tr><td class="paramname">reg_addr</td><td></td></tr>
    <tr><td class="paramname">data</td><td></td></tr>
    <tr><td class="paramname">len</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<div class="fragment"><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;{</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span>(NULL == internal_master_handle)</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    pthread_spin_lock(&amp;internal_master_handle-&gt;handle_lock);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    mraa_result_t ret =  mraa_i2c_address(internal_master_handle-&gt;i2c_context, slave_addr);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span>(0 == ret)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    {   </div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        ret = mraa_i2c_read_bytes_data(internal_master_handle-&gt;i2c_context, reg_addr, data , len);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        (ret == len) ? ret = 0 : 0; </div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    pthread_spin_unlock(&amp;internal_master_handle-&gt;handle_lock);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;}</div></div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="my__i2c_8c_ab25650a9cf74e65561b1fced3555f36c_icgraph.png" border="0" usemap="#my__i2c_8c_ab25650a9cf74e65561b1fced3555f36c_icgraph" alt=""/></div>
<map name="my__i2c_8c_ab25650a9cf74e65561b1fced3555f36c_icgraph" id="my__i2c_8c_ab25650a9cf74e65561b1fced3555f36c_icgraph">
<area shape="rect" id="node2" href="apds9301__sensor_8h.html#ad0dcd5037cad9e4ed654da7d9d548010" title="APDS9301_read_ThLow" alt="" coords="250,5,415,32"/>
<area shape="rect" id="node3" href="apds9301__sensor_8h.html#ab7d8d5ac5b780bcdb0a399f286b7f224" title="APDS9301_read_ThHigh" alt="" coords="249,56,417,83"/>
<area shape="rect" id="node4" href="tmp102__sensor_8h.html#a7d4d57387ef6a5db5bfc8d14a94d9ee4" title="TMP102_setMode_SD_PowerSaving" alt="" coords="213,107,452,133"/>
<area shape="rect" id="node5" href="tmp102__sensor_8h.html#a4309a30e9d006753c2cdd6f6c9af2650" title="TMP102_setMode_SD_Continuous\l_default" alt="" coords="219,158,446,199"/>
<area shape="rect" id="node7" href="tmp102__sensor_8h.html#a81c75dba63b6c0727ab602ea631b3a22" title="TMP102_setMode_TM_Comparator\lMode_default" alt="" coords="218,223,447,265"/>
<area shape="rect" id="node8" href="tmp102__sensor_8h.html#a4386703b35277dc71be5cd9b57d0f3ce" title="TMP102_setMode_TM_InterruptMode" alt="" coords="212,289,453,316"/>
<area shape="rect" id="node9" href="tmp102__sensor_8h.html#a899854f020db34f588f89adffcdc8433" title="TMP102_setMode_ALERT\l_ActiveLow_default" alt="" coords="243,341,422,382"/>
<area shape="rect" id="node10" href="tmp102__sensor_8h.html#aa7438de8c6766d48b649e132cabf88e9" title="TMP102_setMode_ALERT\l_ActiveHigh" alt="" coords="243,406,422,447"/>
<area shape="rect" id="node11" href="tmp102__sensor_8h.html#aa96f470639b851a96f524ae6524dd266" title="TMP102_setMode_EM_Normal\lMode_default" alt="" coords="231,471,435,513"/>
<area shape="rect" id="node12" href="tmp102__sensor_8h.html#a2df18183afad1339903fe59997aaf9a2" title="TMP102_setMode_EM_ExtendedMode" alt="" coords="208,537,457,564"/>
<area shape="rect" id="node13" href="tmp102__sensor_8h.html#a3f6277d742af4a10dcec568e84ad1d5d" title="TMP102_setMode_CR_250mHZ" alt="" coords="227,588,439,615"/>
<area shape="rect" id="node14" href="tmp102__sensor_8h.html#a110d2f8672865d85670f2681e5dc9aed" title="TMP102_setMode_CR_1HZ" alt="" coords="239,639,426,665"/>
<area shape="rect" id="node15" href="tmp102__sensor_8h.html#a6d24a33a5e009441edb99bd1a727afec" title="TMP102_setMode_CR_4HZ\l_default" alt="" coords="239,690,426,731"/>
<area shape="rect" id="node16" href="tmp102__sensor_8h.html#a031c7291b177515876ebb29d24dc97b4" title="TMP102_setMode_CR_8HZ" alt="" coords="239,756,426,783"/>
<area shape="rect" id="node17" href="tmp102__sensor_8h.html#a98961eafa743b9a651a3cd2f3787f858" title="TMP102_readMode_ALERT" alt="" coords="240,807,425,833"/>
<area shape="rect" id="node18" href="tmp102__sensor_8h.html#a6296f70167b1f662c7f9b56b15fe037c" title="TMP102_write_Tlow" alt="" coords="262,857,403,884"/>
<area shape="rect" id="node19" href="tmp102__sensor_8h.html#a32a4b8bbc5611a7ca967cdaaeb732ae1" title="TMP102_write_Thigh" alt="" coords="260,908,405,935"/>
<area shape="rect" id="node20" href="tmp102__sensor_8h.html#aa8531a04dcf776f0d81d190b384bfab5" title="TMP102_read_Tlow" alt="" coords="263,959,402,985"/>
<area shape="rect" id="node21" href="tmp102__sensor_8h.html#a63bbac70f6558fd10f034a45d1fa140c" title="TMP102_read_Thigh" alt="" coords="261,1009,404,1036"/>
<area shape="rect" id="node22" href="tmp102__sensor_8h.html#a847d6333b56e33f815bb5e1101056e42" title="Gets the temperature value. " alt="" coords="268,1060,397,1087"/>
<area shape="rect" id="node23" href="tmp102__sensor_8h.html#a1ea9cb5a6a2e798b33564f9142d7afa1" title="Gives a memdump of 4 len. IMP must free the address using return pointer. " alt="" coords="261,1111,404,1137"/>
<area shape="rect" id="node6" href="tmp102__sensor_8h.html#a4725fb3e4cf18de4220d6067a7dc5dd4" title="Brings back to default. " alt="" coords="505,348,696,375"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af92cf5a5d893ef9bbf6b4ee6de0b0ef8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int I2Cmaster_write </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>reg_addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Writes a byte/pointer register to the slave. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave_addr</td><td></td></tr>
    <tr><td class="paramname">reg_addr</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<div class="fragment"><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span>(NULL == internal_master_handle)</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    pthread_spin_lock(&amp;internal_master_handle-&gt;handle_lock);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    mraa_result_t ret =  mraa_i2c_address(internal_master_handle-&gt;i2c_context, slave_addr);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">if</span>(0 == ret)</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    {   </div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        ret = mraa_i2c_write_byte(internal_master_handle-&gt;i2c_context, reg_addr);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    }</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    pthread_spin_unlock(&amp;internal_master_handle-&gt;handle_lock);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;}</div></div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="my__i2c_8c_af92cf5a5d893ef9bbf6b4ee6de0b0ef8_icgraph.png" border="0" usemap="#my__i2c_8c_af92cf5a5d893ef9bbf6b4ee6de0b0ef8_icgraph" alt=""/></div>
<map name="my__i2c_8c_af92cf5a5d893ef9bbf6b4ee6de0b0ef8_icgraph" id="my__i2c_8c_af92cf5a5d893ef9bbf6b4ee6de0b0ef8_icgraph">
<area shape="rect" id="node2" href="apds9301__sensor_8h.html#aedfa265fc5f3043cea294a0a5d30da04" title="APDS9301_clearPendingInterrupt" alt="" coords="172,5,389,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a202be1d68320e3ba93c759821ba2f695"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int I2Cmaster_write_byte </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>reg_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave_addr</td><td></td></tr>
    <tr><td class="paramname">reg_addr</td><td></td></tr>
    <tr><td class="paramname">data</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<div class="fragment"><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;{</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">if</span>(NULL == internal_master_handle)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    pthread_spin_lock(&amp;internal_master_handle-&gt;handle_lock);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    mraa_result_t ret =  mraa_i2c_address(internal_master_handle-&gt;i2c_context, slave_addr);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span>(0 == ret)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    {   </div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        ret = mraa_i2c_write_byte_data(internal_master_handle-&gt;i2c_context, data, reg_addr);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    pthread_spin_unlock(&amp;internal_master_handle-&gt;handle_lock);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div></div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="my__i2c_8c_a202be1d68320e3ba93c759821ba2f695_icgraph.png" border="0" usemap="#my__i2c_8c_a202be1d68320e3ba93c759821ba2f695_icgraph" alt=""/></div>
<map name="my__i2c_8c_a202be1d68320e3ba93c759821ba2f695_icgraph" id="my__i2c_8c_a202be1d68320e3ba93c759821ba2f695_icgraph">
<area shape="rect" id="node2" href="apds9301__sensor_8h.html#a5e527c870fed599e87d712a151e47172" title="APDS9301_mode_highGain" alt="" coords="223,5,407,32"/>
<area shape="rect" id="node3" href="apds9301__sensor_8h.html#aa8c71ee19fe0ef5ff8880f87daa2757a" title="APDS9301_mode_lowGain\l_default" alt="" coords="225,57,405,98"/>
<area shape="rect" id="node5" href="apds9301__sensor_8h.html#a69d91df573c8c448a30715ae605262d7" title="APDS9301_mode_interrupt" alt="" coords="225,123,405,149"/>
<area shape="rect" id="node6" href="apds9301__sensor_8h.html#ad22326035668d08e6d7cade8cde126e4" title="APDS9301_mode_manualcontrol" alt="" coords="208,173,423,200"/>
<area shape="rect" id="node7" href="apds9301__sensor_8h.html#ac14a5a102513243824d12e6028abbeb8" title="APDS9301_mode_integrationTime" alt="" coords="204,224,427,251"/>
<area shape="rect" id="node8" href="apds9301__sensor_8h.html#a5f0928561f20743cccb1a4f6336ddff4" title="APDS9301_poweron" alt="" coords="244,275,387,301"/>
<area shape="rect" id="node11" href="apds9301__sensor_8h.html#a2ddb9f93c9fac9cb3fbe152bda7bc43b" title="APDS9301_powerdown" alt="" coords="235,325,395,352"/>
<area shape="rect" id="node4" href="apds9301__sensor_8h.html#a47621b827697481f12f3bf6257118f70" title="Sets back the default configration of the sensor. " alt="" coords="475,64,688,91"/>
<area shape="rect" id="node9" href="light__sensor__task_8c.html#abb5f74ca3376b1b610b7dac47ecae8d8" title="light_task_queue_init" alt="" coords="509,300,653,327"/>
<area shape="rect" id="node10" href="light__sensor__task_8h.html#a638f4ba787ad818d90477af9e572771c" title="Entry point of the light task thread. " alt="" coords="736,300,869,327"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a19c6244da5ea2d4e65a25001582498c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int I2Cmaster_write_word </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>slave_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>reg_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>lsb_first</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">slave_addr</td><td></td></tr>
    <tr><td class="paramname">reg_addr</td><td></td></tr>
    <tr><td class="paramname">data</td><td></td></tr>
    <tr><td class="paramname">lsb_first</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<div class="fragment"><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;{</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">if</span>(NULL == internal_master_handle)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    </div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span>(lsb_first)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        data = ( ((data &amp; 0xF0)&gt;&gt;4)| ((data &amp;0x0F)&lt;&lt;4) ); </div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    pthread_spin_lock(&amp;internal_master_handle-&gt;handle_lock);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    mraa_result_t ret =  mraa_i2c_address(internal_master_handle-&gt;i2c_context, slave_addr);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">if</span>(0 == ret)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    {   </div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        ret = mraa_i2c_write_word_data(internal_master_handle-&gt;i2c_context, data, reg_addr);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    pthread_spin_unlock(&amp;internal_master_handle-&gt;handle_lock);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;}</div></div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="my__i2c_8c_a19c6244da5ea2d4e65a25001582498c8_icgraph.png" border="0" usemap="#my__i2c_8c_a19c6244da5ea2d4e65a25001582498c8_icgraph" alt=""/></div>
<map name="my__i2c_8c_a19c6244da5ea2d4e65a25001582498c8_icgraph" id="my__i2c_8c_a19c6244da5ea2d4e65a25001582498c8_icgraph">
<area shape="rect" id="node2" href="apds9301__sensor_8h.html#a27508ac9add1cd27cb2c143631f3a55f" title="APDS9301_write_ThLow" alt="" coords="247,5,415,32"/>
<area shape="rect" id="node3" href="apds9301__sensor_8h.html#ad75b8b8d703f549994213adeaea90c64" title="APDS9301_write_ThHigh" alt="" coords="246,56,417,83"/>
<area shape="rect" id="node4" href="tmp102__sensor_8h.html#a4725fb3e4cf18de4220d6067a7dc5dd4" title="Brings back to default. " alt="" coords="504,340,695,367"/>
<area shape="rect" id="node5" href="tmp102__sensor_8h.html#a7d4d57387ef6a5db5bfc8d14a94d9ee4" title="TMP102_setMode_SD_PowerSaving" alt="" coords="212,157,451,184"/>
<area shape="rect" id="node6" href="tmp102__sensor_8h.html#a4309a30e9d006753c2cdd6f6c9af2650" title="TMP102_setMode_SD_Continuous\l_default" alt="" coords="218,209,445,250"/>
<area shape="rect" id="node7" href="tmp102__sensor_8h.html#a81c75dba63b6c0727ab602ea631b3a22" title="TMP102_setMode_TM_Comparator\lMode_default" alt="" coords="217,274,446,315"/>
<area shape="rect" id="node8" href="tmp102__sensor_8h.html#a4386703b35277dc71be5cd9b57d0f3ce" title="TMP102_setMode_TM_InterruptMode" alt="" coords="211,340,452,367"/>
<area shape="rect" id="node9" href="tmp102__sensor_8h.html#a899854f020db34f588f89adffcdc8433" title="TMP102_setMode_ALERT\l_ActiveLow_default" alt="" coords="242,391,421,433"/>
<area shape="rect" id="node10" href="tmp102__sensor_8h.html#aa7438de8c6766d48b649e132cabf88e9" title="TMP102_setMode_ALERT\l_ActiveHigh" alt="" coords="242,457,421,498"/>
<area shape="rect" id="node11" href="tmp102__sensor_8h.html#aa96f470639b851a96f524ae6524dd266" title="TMP102_setMode_EM_Normal\lMode_default" alt="" coords="229,522,433,563"/>
<area shape="rect" id="node12" href="tmp102__sensor_8h.html#a2df18183afad1339903fe59997aaf9a2" title="TMP102_setMode_EM_ExtendedMode" alt="" coords="207,588,456,615"/>
<area shape="rect" id="node13" href="tmp102__sensor_8h.html#a3f6277d742af4a10dcec568e84ad1d5d" title="TMP102_setMode_CR_250mHZ" alt="" coords="225,639,437,665"/>
<area shape="rect" id="node14" href="tmp102__sensor_8h.html#a110d2f8672865d85670f2681e5dc9aed" title="TMP102_setMode_CR_1HZ" alt="" coords="238,689,425,716"/>
<area shape="rect" id="node15" href="tmp102__sensor_8h.html#a6d24a33a5e009441edb99bd1a727afec" title="TMP102_setMode_CR_4HZ\l_default" alt="" coords="238,741,425,782"/>
<area shape="rect" id="node16" href="tmp102__sensor_8h.html#a031c7291b177515876ebb29d24dc97b4" title="TMP102_setMode_CR_8HZ" alt="" coords="238,807,425,833"/>
<area shape="rect" id="node17" href="tmp102__sensor_8h.html#a6296f70167b1f662c7f9b56b15fe037c" title="TMP102_write_Tlow" alt="" coords="261,857,402,884"/>
<area shape="rect" id="node18" href="tmp102__sensor_8h.html#a32a4b8bbc5611a7ca967cdaaeb732ae1" title="TMP102_write_Thigh" alt="" coords="259,908,404,935"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a24206855ca77b181de1cfbe8e9e5051a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void printErrorCode </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>errorCode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints the error code string to stdout. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">errorCode</td><td></td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">//#define VERBOSE</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">    #ifdef VERBOSE</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    mraa_result_print(errorCode);</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">    #endif</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;}</div></div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="my__i2c_8c_a24206855ca77b181de1cfbe8e9e5051a_icgraph.png" border="0" usemap="#my__i2c_8c_a24206855ca77b181de1cfbe8e9e5051a_icgraph" alt=""/></div>
<map name="my__i2c_8c_a24206855ca77b181de1cfbe8e9e5051a_icgraph" id="my__i2c_8c_a24206855ca77b181de1cfbe8e9e5051a_icgraph">
<area shape="rect" id="node2" href="light__sensor__task_8c.html#abb5f74ca3376b1b610b7dac47ecae8d8" title="light_task_queue_init" alt="" coords="179,5,323,32"/>
<area shape="rect" id="node4" href="temperature__sensor__task_8c.html#ad16d2f35c6d97e33cfe57e3ab2497064" title="temperature_task_I2Cinit" alt="" coords="167,56,335,83"/>
<area shape="rect" id="node6" href="temperature__sensor__task_8c.html#a7b3917c753224bc64f378ca8e61cc941" title="temperature_task_I2Cdeinit" alt="" coords="160,107,343,133"/>
<area shape="rect" id="node3" href="light__sensor__task_8h.html#a638f4ba787ad818d90477af9e572771c" title="Entry point of the light task thread. " alt="" coords="413,5,547,32"/>
<area shape="rect" id="node5" href="temperature__sensor__task_8h.html#abc96664d611b8a19036cf6fcaaf92ac8" title="Entry point of the temp task thread. " alt="" coords="391,81,569,108"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Mar 18 2018 03:32:08 for ECEN5013 Project1 - Gunj Manseta by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
